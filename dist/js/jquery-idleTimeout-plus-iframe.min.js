!function(n){n.fn.idleTimeout=function(t){var i={idleTimeLimit:1200,idleCheckHeartbeat:2,activityEvents:"click keypress scroll wheel mousewheel mousemove touchmove",warningEnabled:!0,warningTimeLimit:180,warningTitle:"Session Timeout",warningMessage:"Your session is about to expire!",warningCountdownMessage:"Time remaining: {timer}",warningStayConnectedButton:"Stay Connected",warningLogoutButton:"Logout",warningWindowTitle:!1,warningBootstrapped:!1,warningCountdownBar:!1,redirectUrl:"/timed-out",logoutUrl:"/logout",logoutAutoUrl:"/logout-notice",onWarn:!1,onLogout:!1,onLogoutAuto:!1,onRedirect:!1,keepAliveInterval:600,keepAliveUrl:window.location.href,keepAliveAjaxType:"GET",keepAliveAjaxData:"",iframesSupport:!1,multiWindowSupport:!0},e=n.extend(i,t);if(e.idleTimeLimit=1e3*e.idleTimeLimit,e.idleCheckHeartbeat=1e3*e.idleCheckHeartbeat,e.warningTimeLimit=1e3*e.warningTimeLimit,e.keepAliveInterval=1e3*e.keepAliveInterval,e.iframesSupport&&!e.multiWindowSupport)return!1;if(e.multiWindowSupport&&!n.localStorage)return!1;if(e.warningEnabled&&"function"!=typeof e.onWarn)if(e.warningBootstrapped){if("undefined"==typeof n.fn.modal)return!1}else if("undefined"==typeof jQuery.ui)return!1;var o=null;o=e.multiWindowSupport?n.initNamespaceStorage("jqueryIdleTimeoutPlus").localStorage:{},this.logout=function(){l("logoutTriggered",!0)},this.showWarningDialog=function(){A()},this.clearWarningTimer=function(){v()},this.iframeRecheck=function(){H()};var a,r,l=function(n,t){e.multiWindowSupport?o.set(n,t):o[n]=t},u=function(n,t){if(t="undefined"!=typeof t?t:null,e.multiWindowSupport){if(o.isSet(n))return o.get(n)}else if(n in o)return o[n];return t},d=[-1,-1],c=function(){s(),l("lastActivity",n.now()),a=setInterval(g,e.idleCheckHeartbeat)},s=function(){clearInterval(a)},g=function(){var t=u("lastActivity",n.now())+e.idleTimeLimit;return u("logoutTriggered")===!0?j():n.now()>=t?f():void 0},f=function(){return e.warningEnabled?(p(),"function"==typeof e.onWarn?e.onWarn(e):void(L()!==!0&&A())):x()},m=function(){n(document).on(e.activityEvents,function(n){if("mousemove"===n.type){if(n.clientX===d[0]&&n.clientY===d[1])return;d[0]=n.clientX,d[1]=n.clientY}-1==u("warningStartTime",-1)&&c()})},w=function(){setInterval(function(){n.ajax({type:e.keepAliveAjaxType,url:e.keepAliveUrl,data:e.keepAliveAjaxData})},e.keepAliveInterval)},p=function(){s(),l("warningStartTime",n.now()),r=setInterval(y,500)},v=function(){h(),l("warningStartTime",-1),c()},h=function(){clearInterval(r)},y=function(){if(u("logoutTriggered")===!0)return j();if(-1==u("warningStartTime",-1))return v(),k();var t=u("warningStartTime")+e.warningTimeLimit;return n.now()>=t?(h(),x()):void(L()&&C())},b=!1,T=null,S=null,A=function(){b||W(),C(),e.warningBootstrapped?T.modal("show"):T.dialog("open")},k=function(){L()&&(e.warningBootstrapped?(T.modal("hide"),n("body").removeClass("modal-open"),n("div.modal-backdrop").remove()):T.dialog("close"))},L=function(){return n("#idletimeout-warning-dialog").is(":visible")===!0},C=function(){var t=n.now(),i=Math.floor((u("warningStartTime",t)+e.warningTimeLimit-t)/1e3);if(0!=e.warningCountdownMessage){var o=Math.floor(i/60),a=i%60,r=o>0?o+"m ":"";r+=a+"s",S.text(r)}if(0!=e.warningCountdownBar){var l=100*Math.floor(i/e.warningTimeLimit);T.find(".countdown-bar").css("width",l+"%")}},B=function(){h(),E()},I=function(){k(),v()},W=function(){var t="";if(e.warningCountdownMessage!==!1&&(t="<p>"+e.warningCountdownMessage.replace(/{timer}/g,'<span class="countdown-holder"></span>')+"</p>"),e.warningBootstrapped){var i=e.warningCountdownBar?'<div class="progress">                       <div class="progress-bar progress-bar-striped countdown-bar active" role="progressbar" style="min-width: 15px; width: 100%;">                         <span class="countdown-holder"></span>                       </div>                     </div>':"";n("body").append('<div class="modal fade" id="idletimeout-warning-dialog">                         <div class="modal-dialog">                             <div class="modal-content">                                 <div class="modal-header">                                     <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                                     <h4 class="modal-title">'+e.warningTitle+'</h4>                             </div>                             <div class="modal-body">                                 <p>'+e.warningMessage+"</p>                                 "+t+"                                 "+i+'                             </div>                             <div class="modal-footer">                                 <button id="idletimeout-warning-logout" type="button" class="btn btn-default">'+e.warningLogoutButton+'</button>                                 <button id="idletimeout-warning-stayconnected" type="button" class="btn btn-primary" data-dismiss="modal">'+e.warningStayConnectedButton+"</button>                             </div>                         </div>                     </div>                 </div>"),n("#idletimeout-warning-logout").on("click",function(){B()}),n("#idletimeout-warning-dialog").on("hidden.bs.modal",function(){I()})}else{var o='<div id="idletimeout-warning-dialog"><p>'+e.warningMessage+"</p>"+t+"</div>";n(o).dialog({buttons:[{text:e.warningLogoutButton,click:function(){B()}},{text:e.warningStayConnectedButton,click:function(){I()}}],closeOnEscape:!1,modal:!0,title:e.warningTitle,autoOpen:!1,open:function(){n(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()}})}b=!0,T=n("#idletimeout-warning-dialog"),S=T.find(".countdown-holder")},E=function(){return l("logoutTriggered",!0),"function"==typeof e.onLogout?e.onLogout(e):void(window.location=e.logoutUrl)},j=function(){return"function"==typeof e.onLogoutAuto?e.onLogoutAuto(e):void(window.location=e.logoutAutoUrl)},x=function(){return"function"==typeof e.onRedirect?e.onRedirect(e):void(window.location.href=e.redirectUrl)},M=function(){l("activityEvents",e.activityEvents)},U=function(){n(document).on("dialogopen shown.bs.modal",function(){L()||H()})},H=function(){var n,t=function(){"complete"===document.readyState&&(clearInterval(n),R())};n=setInterval(t,1e3)},R=function(t){t||(t=n(document));var i=0;t.find("iframe,frame").each(function(){if(n(this).hasClass("jitp-inspected")===!1)try{R(n(this).contents()),n(this).on("load",D(n(this)));var t=n(this)[i];t.attachEvent&&t.attachEvent("onload",D(n(this))),i++}catch(e){n(this).addClass("jitp-inspected cross-site")}})},D=function(t){var i=t.contents(),e=u("activityEvents","");try{i.on(e,function(t){n("body").trigger(t)}),t.addClass("jitp-inspected")}catch(o){}};return this.each(function(){l("logoutTriggered",!1),l("warningStartTime",-1),l("lastActivity",n.now()),M(),U(),m(),e.keepAliveInterval&&w(),c(),H()})}}(jQuery);